YUI.add("moodle-gradereport_grader-gradereporttable",function(e,t){var n="moodle-gradereport_grader-gradereporttable";M.gradereport_grader=M.gradereport_grader||{},M.gradereport_grader.gradereporttable={node_student_header_cell:{},node_student_cell:{},node_footer_row:{},scrollevent:function(){console.log("scrolll event")},init:function(){this.node_student_header_cell=e.one("#studentheader"),this.node_student_cell=e.one("#user-grades .user.cell"),this.node_footer_row=e.one("#user-grades .avg");if(this.node_student_cell){this.float_user_column(),this.float_assignment_header(),this.float_user_header();var t=function(){var e=document.getElementById("gradebook-header-container"),t=document.getElementById("studentheader"),n=document.getElementById("gradebook-user-header-container"),r=t.offsetTop+t.offsetParent.offsetTop,i=window.pageXOffset,s=document.querySelectorAll("#user-grades .user.cell")[0],o=s.offsetLeft+s.offsetParent.offsetLeft,u=document.getElementById("gradebook-user-container"),a=document.querySelectorAll("#user-grades .avg")[0],f,l;a!==undefined&&(f=document.getElementById("gradebook-footer-container"),l=a.offsetTop+a.offsetParent.offsetTop);var c=window.pageYOffset,h=window.innerHeight;e.style.left=t.offsetLeft+t.offsetParent.offsetLeft+"px",c>r?(e.style.top=c+40+"px",n.style.top=c+40+"px"):(e.style.top=r+"px",n.style.top=r+"px"),i>o?(u.style.left=i+"px",n.style.left=i+"px"):(u.style.left=o+"px",n.style.left=o+"px"),a!==undefined&&(f.style.left=t.offsetLeft+t.offsetParent.offsetLeft+"px",c+h<l?(f.style.top=c+h-50+"px",f.classList.add("gradebook-footer-row-sticky")):(f.style.top=l+"px",f.classList.remove("gradebook-footer-row-sticky")))};this.node_footer_row&&this.float_assignment_footer(),t(),window.onscroll=t,window.onresize=function(){t();var n=e.all("#gradebook-header-container .gradebook-header-cell"),r=e.all("#user-grades .heading .cell"),i=e.one("#studentheader").getX(),s=0;r.each(function(e,t){var r=n.item(t);s+=e.get("offsetWidth");var o={width:e.get("offsetWidth"),left:e.getX()-i+"px"};r.setStyles(o)});var o=e.all("#gradebook-footer-container .gradebook-footer-cell");if(o.size()!==0){var u=e.all("#user-grades .avg .cell");u.each(function(e,t){var n=o.item(t),r={width:e.get("offsetWidth"),left:e.getX()-i+"px"};n.setStyles(r)}),e.one("#gradebook-footer-container").setStyle("width",s)}e.one("#gradebook-header-container").setStyle("width",s)}}e.on("domready",function(){e.one(".gradebook-loading-screen").remove(!0),e.all("#user-grades .overridden").setAttribute("aria-label","Overriden grade")})},float_user_column:function(){var t=e.all("#user-grades .user.cell"),n=e.Node.create('<div aria-hidden="true" id="gradebook-user-container"></div>'),r=0,i=this.node_student_cell.getY();t.each(function(t){var s=e.Node.create('<div class="gradebook-user-cell"></div>'),o=t.cloneNode(!0);s.append(o.getHTML()),o=null,s.setStyles({height:t.get("offsetHeight")+"px",width:t.get("offsetWidth")+"px",position:"absolute",top:t.getY()-i+"px"}),r+=t.get("offsetHeight");var u=t.ancestor().getAttribute("class").split(" ").join(".");s.on("click",function(){e.one("."+u).all(".grade").toggleClass("hmarked")}),n.appendChild(s)},this),n.setStyles({position:"absolute",left:this.node_student_cell.getX()+"px",top:this.node_student_cell.getY()+"px",width:this.node_student_cell.get("offsetWidth"),height:r+"px","background-color":"#f9f9f9"}),e.one("body").append(n)},float_user_header:function(){var t=e.Node.create('<div aria-hidden="true" id="gradebook-user-header-container"></div>'),n=this.node_student_header_cell.cloneNode(!0);t.append(n.getHTML()),t.setStyles({position:"absolute",left:this.node_student_cell.getX()+"px",top:this.node_student_header_cell.getY()+"px",width:"200px",height:this.node_student_header_cell.get("offsetHeight")+"px"}),n=null,e.one("body").append(t)},float_assignment_header:function(){var t=e.all("#user-grades tr.heading .cell"),n=e.Node.create('<div aria-hidden="true" id="gradebook-header-container"></div>'),r=0,i=0,s=this.node_student_header_cell.getX();t.each(function(t){var o=t.getAttribute("class"),u=/c[0-9]+/g,a=u.exec(o);a=a[0].replace("c","");var f=parseInt(a,10);++f;var l=t.getX(),c=t.cloneNode(!0),h=e.Node.create('<div class="gradebook-header-cell"></div>');h.append(c.getHTML()),h.addClass(c.getAttribute("class")),c=null,h.setStyles({width:t.get("offsetWidth")+"px",height:t.get("offsetHeight")+"px",position:"absolute",left:l-s+"px"}),r+=parseInt(t.get("offsetWidth"),10),i=t.get("offsetHeight"),h.on("click",function(){e.all(".cell.c"+f).toggleClass("vmarked")}),n.appendChild(h)},this),n.setStyles({position:"absolute",top:this.node_student_header_cell.getY()+"px",left:this.node_student_header_cell.getX()+"px",width:r+"px",height:i+"px"}),e.one("body").append(n)},float_assignment_footer:function(){var t=e.all("#user-grades .lastrow .cell"),n=e.Node.create('<div aria-hidden="true" id="gradebook-footer-container"></div>'),r=0,i=this.node_footer_row.getX();t.each(function(t){var s=t.getX(),o=t.cloneNode(!0),u=e.Node.create('<div class="gradebook-footer-cell"></div>');u.append(o.getHTML()),u.setStyles({width:t.get("offsetWidth")+"px",height:"50px",position:"absolute",left:s-i+"px"}),n.append(u),r+=parseInt(t.get("offsetWidth"),10)},this);var s=e.one("#gradersubmit");if(s){var o=e.Node.create('<button class="btn btn-sm btn-default">'+s.getAttribute("value")+"</button>");o.on("click",function(){YUI().use("node-event-simulate",function(e){e.one("#gradersubmit").simulate("click")})}),n.one(".gradebook-footer-cell").append(o)}n.setStyles({position:"absolute",left:this.node_footer_row.getX()+"px",bottom:"0",height:"50px",width:r+"px"}),e.one("body").append(n)}}},"@VERSION@");
